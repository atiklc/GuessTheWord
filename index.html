<!doctype html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GuessTheWord - Web</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f3f6fc;margin:0;padding:24px;display:flex;justify-content:center}
    .card{width:min(92vw,760px);background:#fff;border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.08);padding:20px}
    h1{margin-top:0}.row{display:grid;gap:8px;margin:12px 0}input,button{padding:10px;border-radius:8px;border:1px solid #cbd5e1}
    button{background:#2563eb;color:#fff;border:none;cursor:pointer}button.secondary{background:#64748b}
    .hidden{display:none}.ok{color:#166534}.err{color:#b91c1c}ol{padding-left:20px}
  </style>
</head>
<body>
  <main class="card">
    <h1>Kelime Tahmin Oyunu</h1>

    <section id="setup">
      <p>OyuncularÄ± virgÃ¼lle girin, tur sayÄ±sÄ±nÄ± seÃ§in ve oyunu baÅŸlatÄ±n.</p>
      <div class="row">
        <label>Oyuncular</label>
        <input id="playersInput" placeholder="AyÅŸe, Mehmet, Zeynep" />
      </div>
      <div class="row">
        <label>Tur SayÄ±sÄ±</label>
        <input id="roundCountInput" type="number" min="1" value="3" />
      </div>
      <button id="startBtn">Oyunu BaÅŸlat</button>
    </section>

    <section id="game" class="hidden">
      <p><b>Tur:</b> <span id="roundLabel"></span></p>
      <p><b>Ä°pucu:</b> <span id="hint"></span></p>
      <p><b>Kelime UzunluÄŸu:</b> <span id="wordLength"></span></p>
      <p><b>SÄ±radaki Oyuncu:</b> <span id="currentPlayer"></span></p>

      <div class="row">
        <label>Tahmin</label>
        <input id="guessInput" placeholder="Kelime tahmini" />
      </div>
      <button id="guessBtn">Tahmin Et</button>
      <p id="message"></p>

      <h3>Ara Skor Tablosu</h3>
      <ol id="liveScoreboard"></ol>
    </section>

    <section id="result" class="hidden">
      <h2>Final Skor Tablosu</h2>
      <ol id="scoreboard"></ol>
      <p id="winner" class="ok"></p>
      <button class="secondary" id="newGameBtn">Yeni Oyun</button>
    </section>
  </main>

  <script>
    const words = ["bilgisayar", "yazilim", "algoritma", "oyuncak", "macera", "kelime", "bulmaca"];
    const points = [400, 300, 200, 100];

    const state = {
      players: [],
      scores: {},
      totalRounds: 1,
      currentRound: 1,
      currentIndex: 0,
      secretWord: "",
      correctOrder: []
    };

    const $ = (id) => document.getElementById(id);

    function pickWord() {
      return words[Math.floor(Math.random() * words.length)];
    }

    function generateHint(word) {
      const revealCount = Math.max(1, Math.round(word.length * 0.35));
      const indexes = new Set();
      while (indexes.size < revealCount) indexes.add(Math.floor(Math.random() * word.length));
      return [...word].map((ch, i) => indexes.has(i) ? ch : "_").join("");
    }

    function sortedScores() {
      return Object.entries(state.scores).sort((a, b) => b[1] - a[1]);
    }

    function renderScoreboard(targetId) {
      const list = $(targetId);
      list.innerHTML = "";
      sortedScores().forEach(([name, score]) => {
        const li = document.createElement("li");
        li.textContent = `${name}: ${score} puan`;
        list.appendChild(li);
      });
    }

    function startRound() {
      state.secretWord = pickWord();
      state.correctOrder = [];
      state.currentIndex = 0;

      $("roundLabel").textContent = `${state.currentRound} / ${state.totalRounds}`;
      $("hint").textContent = generateHint(state.secretWord);
      $("wordLength").textContent = state.secretWord.length;
      $("guessInput").value = "";
      $("message").textContent = "";
      $("message").className = "";
      $("currentPlayer").textContent = state.players[state.currentIndex];
      renderScoreboard("liveScoreboard");
    }

    function applyRoundScore() {
      state.correctOrder.slice(0, 4).forEach((name, idx) => {
        state.scores[name] += points[idx];
      });
    }

    function finishGame() {
      renderScoreboard("scoreboard");
      const sorted = sortedScores();
      if (sorted.length) {
        $("winner").textContent = `ðŸ† Kazanan: ${sorted[0][0]} (${sorted[0][1]} puan)`;
      }
      $("game").classList.add("hidden");
      $("result").classList.remove("hidden");
    }

    $("startBtn").addEventListener("click", () => {
      const names = $("playersInput").value.split(",").map(v => v.trim()).filter(Boolean);
      const roundCount = Number($("roundCountInput").value);
      if (!names.length) {
        alert("En az bir oyuncu girin.");
        return;
      }
      if (!Number.isInteger(roundCount) || roundCount < 1) {
        alert("Tur sayÄ±sÄ± 1 veya daha bÃ¼yÃ¼k olmalÄ±.");
        return;
      }

      state.players = names;
      state.scores = Object.fromEntries(names.map(name => [name, 0]));
      state.totalRounds = roundCount;
      state.currentRound = 1;

      $("setup").classList.add("hidden");
      $("result").classList.add("hidden");
      $("game").classList.remove("hidden");
      startRound();
    });

    $("guessBtn").addEventListener("click", () => {
      const guess = $("guessInput").value.trim().toLowerCase();
      if (!guess) return;

      const player = state.players[state.currentIndex];
      if (guess === state.secretWord && !state.correctOrder.includes(player)) {
        state.correctOrder.push(player);
        $("message").textContent = `âœ… ${player} doÄŸru tahmin etti!`;
        $("message").className = "ok";
      } else {
        $("message").textContent = "âŒ YanlÄ±ÅŸ tahmin.";
        $("message").className = "err";
      }

      state.currentIndex += 1;
      $("guessInput").value = "";

      if (state.currentIndex >= state.players.length) {
        applyRoundScore();
        renderScoreboard("liveScoreboard");

        if (state.currentRound < state.totalRounds) {
          state.currentRound += 1;
          $("message").textContent = `Tur bitti. ${state.currentRound}. tura geÃ§iliyor.`;
          $("message").className = "ok";
          startRound();
        } else {
          finishGame();
        }
      } else {
        $("currentPlayer").textContent = state.players[state.currentIndex];
      }
    });

    $("newGameBtn").addEventListener("click", () => {
      $("setup").classList.remove("hidden");
      $("game").classList.add("hidden");
      $("result").classList.add("hidden");
      $("playersInput").value = "";
      $("roundCountInput").value = "3";
    });
  </script>
</body>
</html>
